<% manifest_url = @document['ark']&.gsub('https://n2t.net/ark:', 'https://crkn-iiif-api.azurewebsites.net/manifest') %>
    
<ul class="iiif-tools-list">
  <li>
    <div style="display:flex; align-items: center;">
      <img src="/assets/iiif_logo.png" height="48" style="margin-right:0.5rem;" />
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
          Open IIIF Manifest in...
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
          <li><a class="dropdown-item" href="https://mcgrawcenter.github.io/croppingtool/?manifest=<%= manifest_url %>" target="_blank">Image Cropper</a></li>
          <li><a class="dropdown-item" href="https://pdiiif.jbaiter.de/?manifest=<%= manifest_url %>" target="_blank">Advanced PDF Generator</a></li>
          <li><a class="dropdown-item" href="#" target="_blank">Manifest Editor</a></li>
        </ul>
      </div>
    </div>
  </li>
  <li>
    <div class="d-flex align-items-center gap-2">
      <div>
        <span style="margin-right:0.5rem">IIIF Manifest URL:</span>
        <a id="iiif-manifest-url" href="<%= manifest_url %>"><%= manifest_url %></a>
      </div>
      <button class="btn btn-sm btn-outline-secondary" onclick="copyManifestUrl(this)">Copy</button>
    </div>
  </li>
  <li><a href="">What is IIIF?</a></li>
</ul>



<script>
  function copyManifestUrl(button) {
    const text = document.getElementById("iiif-manifest-url").textContent.trim();

    // Use navigator.clipboard if available
    if (navigator.clipboard && window.isSecureContext) {
      navigator.clipboard.writeText(text).then(() => {
        button.textContent = "Copied!";
        setTimeout(() => button.textContent = "Copy", 2000);
      }).catch(err => {
        console.error("Copy failed", err);
        alert("Failed to copy to clipboard");
      });
    } else {
      // Fallback for insecure contexts (e.g. localhost without HTTPS)
      const tempInput = document.createElement("textarea");
      tempInput.value = text;
      document.body.appendChild(tempInput);
      tempInput.select();
      try {
        document.execCommand("copy");
        button.textContent = "Copied!";
        setTimeout(() => button.textContent = "Copy", 2000);
      } catch (err) {
        console.error("Fallback copy failed", err);
        alert("Copy not supported in this browser.");
      }
      document.body.removeChild(tempInput);
    }
  }
</script>
